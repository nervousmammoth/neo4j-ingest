---
**Status:** To Do
**Priority:** P2-PostMVP (Enhancement)
**Branch:** `feature/P4.2-context-menu`
---

## Overview

Add a context menu to the file grid for quick actions like Rename, Delete, and Download.

---

## User Stories

**As a** user
**I want** to right-click on files to access quick actions
**So that** I can efficiently rename, delete, or copy paths without navigating through menus

**As a** user
**I want** to confirm destructive actions like delete
**So that** I don't accidentally remove important data

**As a** user
**I want** to use keyboard shortcuts (F2 for rename, Delete key)
**So that** I can work quickly with familiar file management patterns

---

## Requirements

- Right-click on file row shows context menu
- Options: Rename, Delete, Download, Copy Path
- Connect "Rename" to a modal/input and then the API
- Connect "Delete" to a confirmation dialog and then the API
- Use shadcn/ui ContextMenu component

---

## Implementation Steps

### Commit 1: `feat: Create FileContextMenu component`

```typescript
// components/file-context-menu.tsx
'use client';

import {
  ContextMenu,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuTrigger,
} from '@/components/ui/context-menu';
import { Pencil, Trash2, Download, Copy } from 'lucide-react';

interface FileContextMenuProps {
  children: React.ReactNode;
  fileKey: string;
  onRename: () => void;
  onDelete: () => void;
}

export function FileContextMenu({
  children,
  fileKey,
  onRename,
  onDelete
}: FileContextMenuProps) {
  return (
    <ContextMenu>
      <ContextMenuTrigger asChild>{children}</ContextMenuTrigger>
      <ContextMenuContent>
        <ContextMenuItem onClick={onRename}>
          <Pencil className="mr-2 h-4 w-4" />
          Rename
        </ContextMenuItem>
        <ContextMenuItem onClick={onDelete} className="text-destructive">
          <Trash2 className="mr-2 h-4 w-4" />
          Delete
        </ContextMenuItem>
        <ContextMenuItem onClick={() => navigator.clipboard.writeText(fileKey)}>
          <Copy className="mr-2 h-4 w-4" />
          Copy Path
        </ContextMenuItem>
      </ContextMenuContent>
    </ContextMenu>
  );
}
```

### Commit 2: `feat: Add RenameDialog component`

Modal dialog for renaming files with validation.

### Commit 3: `feat: Add DeleteConfirmDialog component`

Confirmation dialog before deletion with file name display.

---

## Acceptance Criteria

- [ ] Context menu appears on right-click
- [ ] Rename action opens modal and updates file on submit
- [ ] Delete action shows confirmation and deletes on confirm
- [ ] Toast notifications for success/error
- [ ] Keyboard shortcuts work (F2 for rename, Delete key)

---

## Dependencies

- P1.2 Install shadcn/ui
- P2.4 File Grid
- P4.1 Rename API

## Blocking

- None (end of feature chain)
